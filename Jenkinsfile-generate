#!groovy

node {

  stage('Checkout') {
    checkout scm
    mvn 'clean'
  }

  stage('Generate Plugin Data') {
    mvn '-P generatePluginData'
  }

  stage('Verify Plugin Data') {
    mvn '-P verifyPluginData'
  }

}

def mvn(args) {
  withEnv(["PATH+MAVEN=${tool 'M3'}/bin"]) {
    sh "mvn ${args}"
  }
}
